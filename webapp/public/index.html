<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HUST Quiz System - SOICT</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="toast.css" />
  <!-- Chart.js Library for Statistics Visualization -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <header>
    <div class="logo">
      <div class="logo-title">HUST Quiz System</div>
      <div class="logo-subtitle">Hệ thống thi trắc nghiệm trực tuyến - SOICT</div>
    </div>
    <div class="connect">
      <input id="host" value="127.0.0.1" />
      <input id="port" value="8080" />
      <button id="btn-connect">Connect</button>
      <span id="status" class="pill">Disconnected</span>
    </div>
    <div class="auth">
      <input id="username" value="teacher" placeholder="username" />
      <input id="password" value="teacher123" type="password" placeholder="password" />
      <button id="btn-login">Login</button>
      <button id="btn-register">Register</button>
      <span id="role" class="pill"></span>
    </div>
  </header>

  <div id="notice" class="notice">Not logged in</div>

  <nav id="nav">
    <button data-page="teacher-dashboard" data-role="ADMIN" class="nav-btn disabled">Teacher - Dashboard</button>
    <button data-page="teacher-results" data-role="ADMIN" class="nav-btn disabled">Teacher - Results/History</button>
    <button data-page="student-lobby" data-role="STUDENT" class="nav-btn disabled">Student - Lobby</button>
    <button data-page="student-exam" data-role="STUDENT" class="nav-btn disabled">Student - Exam</button>
    <button data-page="student-practice" data-role="STUDENT" class="nav-btn disabled">Student - Practice</button>
    <button data-page="student-history" data-role="STUDENT" class="nav-btn disabled">Student - History</button>
  </nav>

  <main>
    <section class="panel page" id="teacher-dashboard">
      <h2>Teacher · Rooms</h2>
      <div class="form-grid">
        <label>Name <input id="room-name" value="Demo room" /></label>
        <label>Description <input id="room-desc" value="Test room" /></label>
        <label>Duration (min) <input id="room-dur" type="number" value="30" /></label>
        <label>Total questions <input id="room-total" type="number" value="10" /></label>
        <label>Easy <input id="room-easy" type="number" value="4" /></label>
        <label>Medium <input id="room-med" type="number" value="4" /></label>
        <label>Hard <input id="room-hard" type="number" value="2" /></label>
        <label>Room password <input id="room-pass" type="text" value="1234" /></label>
        <button id="btn-create">Create Room</button>
        <button id="btn-refresh">Refresh Rooms</button>
      </div>
      <table id="rooms-table">
        <thead><tr><th>ID</th><th>Name</th><th>Code</th><th>Status</th><th>Creator</th><th>Participants</th><th>Actions</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <section class="panel page" id="student-lobby">
      <h2>Student · Lobby</h2>
      <div class="row">
        <button id="btn-refresh-lobby">Refresh Rooms</button>
      </div>
      <table id="lobby-table">
        <thead><tr><th>ID</th><th>Name</th><th>Status</th><th>Participants</th><th>Actions</th></tr></thead>
        <tbody></tbody>
      </table>
    </section>

    <section class="panel page" id="student-exam">
      <h2>Student · Exam</h2>
      <div class="row">
        <div id="exam-room-info">Room: (select from lobby)</div>
        <label>Room password <input id="exam-pass" type="text" value="1234" /></label>
        <button id="btn-join-room">Join Room</button>
        <button id="btn-get-paper">Get Paper</button>
        <button id="btn-submit-exam">Submit Exam</button>
        <span id="exam-timer" class="pill">Timer: --:--</span>
      </div>
      <div id="exam-questions" class="cards"></div>
    </section>

    <section class="panel page" id="student-practice">
      <h2>Student · Practice</h2>
      <div class="row">
        <label>Count <input id="prac-count" type="number" value="6" /></label>
        <label>Duration (min) <input id="prac-dur" type="number" value="10" /></label>
        <button id="btn-start-prac">Start Practice</button>
        <button id="btn-submit-prac">Submit Practice</button>
        <span id="prac-timer" class="pill">Timer: --:--</span>
      </div>
      <div id="prac-questions" class="cards"></div>
    </section>

    <section class="panel page" id="teacher-results">
      <h2>Teacher · Results / History</h2>
      <div class="row">
        <label>Room ID <input id="res-room" type="number" /></label>
        <button id="btn-room-results">Get Room Results</button>
        <button id="btn-history-teacher">My History</button>
      </div>

      <!-- Charts Container -->
      <div id="charts-container" style="display: none;">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
          <div>
            <h3>Score Distribution</h3>
            <canvas id="chart-score-distribution"></canvas>
          </div>
          <div>
            <h3>Pass/Fail Rate</h3>
            <canvas id="chart-pass-fail"></canvas>
          </div>
        </div>

        <!-- Detailed Results Table -->
        <div id="results-table-container"></div>
      </div>

      <!-- Fallback for raw data -->
      <pre id="results-teacher" style="display: none;"></pre>
    </section>

    <section class="panel page" id="student-history">
      <h2>Student · History</h2>
      <div class="row">
        <button id="btn-history-student">My History</button>
      </div>
      <pre id="results-student"></pre>
      <pre id="errors"></pre>
    </section>
  </main>

  <!-- Register Modal -->
  <div id="register-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Register New Account</h2>
        <button class="modal-close" id="close-register-modal">&times;</button>
      </div>
      <div class="modal-body">
        <label>
          Username
          <input id="reg-username" type="text" placeholder="Enter username" />
        </label>
        <label>
          Password
          <input id="reg-password" type="password" placeholder="Enter password" />
        </label>
        <label>
          Full Name
          <input id="reg-fullname" type="text" placeholder="Enter your full name" />
        </label>
        <label>
          Email (optional)
          <input id="reg-email" type="email" placeholder="Enter your email" />
        </label>
      </div>
      <div class="modal-footer">
        <button id="btn-register-submit" class="btn-primary">Register</button>
        <button id="btn-register-cancel" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <div class="toast-container" id="toast-container"></div>

  <footer>
    <div class="footer-content">
      <div class="footer-logo">
        <strong>Trường Đại học Bách khoa Hà Nội</strong>
        <span>Viện Công nghệ Thông tin và Truyền thông (SOICT)</span>
      </div>
      <div class="footer-info">
        <p>Số 1 Đại Cồ Việt, Hai Bà Trưng, Hà Nội</p>
        <p>&copy; 2025 HUST. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script src="main.js"></script>
</body>
</html>
